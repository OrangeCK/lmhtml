<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="keywords" content="">
	<meta name="description" content="" />
	<script src="./js/lm.js"></script>
	<script src="./js/jquery-3.3.1.min.js"></script>
	<script src="./js/bootstrap.bundle.min.js" ></script>
	<script src="./js/bootstrap.min.js" ></script>
	<script src="./js/highlight.pack.js" ></script>
	<script>window.jQuery || document.write('<script src="./js/jquery-3.3.1.min.js"><\/script>')</script>
	<link href="./css/iconfont.css" rel="styleSheet" type="text/css">
	<link href="./css/bootstrap.min.css" rel="stylesheet">
	<link href="./css/common.css" rel="styleSheet" type="text/css">
	<link href="./css/markdown.css" rel="styleSheet" type="text/css">
	<link href="./css/styles/idea.css" rel="styleSheet" type="text/css">
    <title>first_vue_project</title>
  </head>
  <style type="text/css">
	.bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
      }
    @media (min-width: 768px) {
		.bd-placeholder-img-lg {
		  font-size: 3.5rem;
		}
	  }
	 .my-sm-0:hover{
		background-color:orange;
	 }
	 .header-famliy{
		font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";
	 }
	 .float-right-p{
		position: fixed;
		z-index:99;
		right:0.5rem; 
		bottom:6rem;
		opacity:0.2;
		
	 }
	 .float-right-p:hover{
		color: blue;
		opacity:0.9;
		cursor: pointer;
	 }
	 .back-to-top{
		font-size: 4rem;
	 }
	 #bubbles{
		 position: fixed;
         background: #fff;
		 overflow: auto;
		 z-index: -1;
    }
	 .footer_div{
		background: url(./image/qunzi.png) no-repeat 50%;
		height: 20rem;
		position: relative;
	 }
	 #cnzz_stat_icon_1277763152 a{
		color: #cccccc;
	 }
  </style>
  <body>
<!--<iframe src="./lmheader.html" width="100%" scrolling="no" id="test" onload="this.height=60" class="fixed-top" ></iframe>-->
<header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark" style="background:linear-gradient(to bottom right,#524E4D, #626063, #898989, #CBD0D3)!important">
      <a class="navbar-brand" href="/index/indexBlogs"><span>首页</span></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto" style="margin:0">
          <li class="nav-item active">
            <a class="nav-link disabled" href="#">橙子的个人生活</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/index/indexBlogs?parentCategoryId=lzcf">栗子厨房</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/index/indexBlogs?parentCategoryId=java">Java</a>
          </li>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
          <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit" style="color:#fff;border-color:orange;">Search</button>
        </form>
      </div>
    </nav>
  </header>
 <main role="main" id="main" class="shadow p-3 mb-5 bg-white rounded" style="margin-top:60px;">
 <div style="margin:0em 0.1em 0em 0.5em;">
    <h1>log4j2的配置，不同级别日志保存在不同文件夹（基于Springboot)</h1>
</div>
  <div>
	<span class="badge badge-light">2019年1月11日22:49:51</span>
	<span class="badge badge-light">栗子味橙子</span>
	<span class="badge badge-primary iconfont icon-06tags"> Java</span>
	<span class="badge badge-pill badge-info iconfont icon-tag-o"> 栗子厨房</span>
  </div>
  <hr style="border-bottom: 1px solid #ddd;">
  <!-- <p>[TOC]</p> -->
<h2>1.前言汇总</h2>
<blockquote>
<ul>
<li>目的是想按照按照规定的格式打印在控制台，以及以文件的形式保存下来，并且按照日志的级别，保存为不同的log文件.</li>
<li>首先你得搭建一个简单的springboot项目，这个就直接在网上查，例子数不胜数</li>
<li>然后在pom.xml文件中添加依赖：</li>
</ul>
</blockquote>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;!--添加log4j的依赖--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>

<blockquote>
<ul>
<li>至于为什么要加上exclusions那一段标签，原因是因为springboot有个默认的日志，叫logback,
其实这个日志也是比较好用的，可以看我的下篇文章阐述；所以要把他排除，不然也许会报出错误。</li>
<li>然后是在resources目录下加入日志的配置文件，至于名字,在log4j2里，配置文件检测的过程如下：</li>
</ul>
<blockquote>
<ol>
<li>log4j会检测名为&quot;log4j.configurationFile&quot;的系统属性值，如果这个值被设置了，则会尝试通过ConfigurationFactory来加载这个值对应的文件。</li>
<li>否则它会尝试查找log4j2-test.properties这个文件。</li>
<li>否则它会尝试查找文件log4j2-test.yaml 和 log4j2-test.yml。</li>
<li>否则它会尝试查找文件log4j2-test.json 和 log4j2-test.jsn。</li>
<li>否则查找文件log4j2-test.xml。</li>
<li>否则查找文件log4j2.properties。</li>
<li>否则查找文件log4j2.yaml 和 log4j2.yml。</li>
<li>否则查找文件log4j2.json 和 log4j2.jsn。</li>
<li>否则查找文件log4j2.xml。</li>
</ol>
</blockquote>
<ul>
<li>我直接取的是log4j2.xml</li>
</ul>
</blockquote>
<h2>log4j2.xml的实际配置</h2>
<blockquote>
<ul>
<li>这里我直接po出整个log4j2.xml吧，详细的解释我就直接写在配置文件中的注释了吧</li>
</ul>
</blockquote>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;Configuration packages=&quot;com.example.baseframe.myspringboot.config&quot;&gt;
&lt;Properties&gt;
    &lt;property name=&quot;Log_Home&quot;&gt;d:/logs/myspringboot/&lt;/property&gt;
&lt;/Properties&gt;
&lt;appenders&gt;
    &lt;!--这个输出控制台的配置--&gt;
    &lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&gt;
        &lt;!--控制台只输出level及以上级别的信息（onMatch），其他的直接拒绝（onMismatch）,ACCEPT(接受其及以上)，DENY(拒绝以下)，NEUTRAL(中立，由下一个ThresholdFilter处理)--&gt;
        &lt;ThresholdFilter level=&quot;TRACE&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot; /&gt;
        &lt;!--输出日志格式--&gt;
        &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss}| %-5level|%ip|%thread| %logger{50}| %msg%n&quot; /&gt;
    &lt;/Console&gt;
    &lt;!--这个会只打印出所有的DEBUG信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;
    &lt;RollingFile name=&quot;RollingFile_Debug&quot; fileName=&quot;${Log_Home}/debug/debug.log&quot; filePattern=&quot;${Log_Home}$${date:yyyy-MM}/app-%d{yyyyMMddHHmmssSSS}.log.gz&quot;&gt;
        &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss}| %-5level|%ip|%thread| %logger{50}| %msg%n&quot; /&gt;
        &lt;!-- 日志文件大小 --&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;20MB&quot; /&gt;
        &lt;!-- 最多保留文件数 --&gt;
        &lt;DefaultRolloverStrategy max=&quot;20&quot;/&gt;
        &lt;!--至于为什么只会打印出DEBUG级别的日志，就是因为下面的Filters标签,
            onMatch=&quot;ACCEPT&quot; 表示匹配该级别及以上
            onMatch=&quot;DENY&quot; 表示不匹配该级别及以上
            onMatch=&quot;NEUTRAL&quot; 表示该级别及以上的，由下一个filter处理，如果当前是最后一个，则表示匹配该级别及以上
            onMismatch=&quot;ACCEPT&quot; 表示匹配该级别以下
            onMismatch=&quot;NEUTRAL&quot; 表示该级别及以下的，由下一个filter处理，如果当前是最后一个，则不匹配该级别以下的--&gt;
        &lt;Filters&gt;
            &lt;ThresholdFilter level=&quot;INFO&quot; onMatch=&quot;DENY&quot; onMismatch=&quot;NEUTRAL&quot;/&gt;
            &lt;ThresholdFilter level=&quot;DEBUG&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;
        &lt;/Filters&gt;
    &lt;/RollingFile&gt;
    &lt;!--这个会只打印出所有的INFO信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;
    &lt;RollingFile name=&quot;RollingFile_Info&quot; fileName=&quot;${Log_Home}/info/info.log&quot; filePattern=&quot;${Log_Home}$${date:yyyy-MM}/app-%d{yyyyMMddHHmmssSSS}.log.gz&quot;&gt;
        &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss}| %-5level|%ip|%thread| %logger{50}| %msg%n&quot; /&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;20MB&quot; /&gt;
        &lt;DefaultRolloverStrategy max=&quot;20&quot;/&gt;
        &lt;Filters&gt;
            &lt;ThresholdFilter level=&quot;WARN&quot; onMatch=&quot;DENY&quot; onMismatch=&quot;NEUTRAL&quot;/&gt;
            &lt;ThresholdFilter level=&quot;INFO&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;
        &lt;/Filters&gt;
    &lt;/RollingFile&gt;
    &lt;!--这个会只打印出所有的WARN信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;
    &lt;RollingFile name=&quot;RollingFile_Warn&quot; fileName=&quot;${Log_Home}/warn/warn.log&quot; filePattern=&quot;${Log_Home}$${date:yyyy-MM}/app-%d{yyyyMMddHHmmssSSS}.log.gz&quot;&gt;
        &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss}| %-5level|%ip|%thread| %logger{50}| %msg%n&quot; /&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;20MB&quot; /&gt;
        &lt;DefaultRolloverStrategy max=&quot;20&quot;/&gt;
        &lt;Filters&gt;
            &lt;ThresholdFilter level=&quot;ERROR&quot; onMatch=&quot;DENY&quot; onMismatch=&quot;NEUTRAL&quot;/&gt;
            &lt;ThresholdFilter level=&quot;WARN&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;
        &lt;/Filters&gt;
    &lt;/RollingFile&gt;
    &lt;!--这个会只打印出所有的ERROR信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档--&gt;
    &lt;RollingFile name=&quot;RollingFile_Error&quot; fileName=&quot;${Log_Home}/error/error.log&quot; filePattern=&quot;${Log_Home}$${date:yyyy-MM}/app-%d{yyyyMMddHHmmssSSS}.log.gz&quot;&gt;
        &lt;PatternLayout pattern=&quot;%d{yyyy-MM-dd HH:mm:ss}| %-5level|%ip|%thread| %logger{50}| %msg%n&quot; /&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;20MB&quot; /&gt;
        &lt;DefaultRolloverStrategy max=&quot;20&quot;/&gt;
        &lt;Filters&gt;
            &lt;ThresholdFilter level=&quot;ERROR&quot; onMatch=&quot;ACCEPT&quot; onMismatch=&quot;DENY&quot;/&gt;
        &lt;/Filters&gt;
    &lt;/RollingFile&gt;
&lt;/appenders&gt;

&lt;Loggers&gt;
    &lt;!--然后定义logger，只有定义了logger并引入的appender，
        appender才会生效，additivity默认是true,表示将此logger的打印信息向上级传递，
        在这儿root就是他的上级，root的设置的打印级别是debug,logger级别没有低于他，
        所以root里面也会打印一遍--&gt;
    &lt;logger name=&quot;com.example.baseframe.myspringboot&quot; level=&quot;DEBUG&quot; additivity=&quot;true&quot;&gt;
        &lt;AppenderRef ref=&quot;RollingFile_Debug&quot; /&gt;
        &lt;AppenderRef ref=&quot;RollingFile_Info&quot; /&gt;
        &lt;AppenderRef ref=&quot;RollingFile_Warn&quot; /&gt;
        &lt;AppenderRef ref=&quot;RollingFile_Error&quot; /&gt;
    &lt;/logger&gt;
    &lt;!--建立一个默认的root的logger--&gt;
    &lt;root level=&quot;DEBUG&quot;&gt;
        &lt;AppenderRef ref=&quot;Console&quot; /&gt;
    &lt;/root&gt;
&lt;/Loggers&gt;
&lt;/Configuration&gt;
</code></pre>

<blockquote>
<ul>
<li>在java代码中怎么使用</li>
</ul>
</blockquote>
<pre><code>public class Log4j2DemoApplication implements ApplicationRunner {
    private static final Logger logger = LogManager.getLogger(Log4j2DemoApplication.class);

    public static void main(String[] args) {
        SpringApplication.run(Log4j2DemoApplication.class, args);
    }

    @Override
    public void run(ApplicationArguments applicationArguments) throws Exception {
        logger.debug(&quot;Debugging log&quot;);
        logger.info(&quot;Info log&quot;);
        logger.warn(&quot;Hey, This is a warning!&quot;);
        logger.error(&quot;Oops! We have an Error. OK&quot;);
        logger.fatal(&quot;Damn! Fatal error. Please fix me.&quot;);
    }
}
</code></pre>
<h2>一级标题</h2>
<ol>
<li>chenshi</li>
<li>ssd</li>
<li>ddd</li>
<li>ddd</li>
<li>sss</li>
<li>ss </li>
</ol>
<h2>二级目录</h2>
<blockquote>
<ul>
<li>这是什么1</li>
<li>这是什么而</li>
<li>这还是什么三</li>
<li>吃饭</li>
</ul>
<blockquote>
<ul>
<li><strong><em>斜粗体</em></strong> </li>
</ul>
</blockquote>
</blockquote>
<h2>名字</h2>
<h2>~~删除~~</h2>
<hr />
<h2><img src="http://2019-2-16-ck.oss-cn-beijing.aliyuncs.com/lmsystem/111111.jpg" alt="史努比" /></h2>
<h2><a href="http://www.baidu.com" title="百度地址">百度</a></h2>
<p>根据<a href="http://google.com/" title="google">谷歌</a>调查</p>
<p>这是新浪的主页 <a href="http://www.sina.com.cn">http://www.sina.com.cn</a> <br />
在java中输出Hello world : <code>system.out.println(&quot;Hello World&quot;);</code></p>
<hr />
<pre><code>// jQuery的helloword
$(function(){
    alert(&quot;Hello World&quot;)
})
</code></pre>

<hr />
<p><code>// jQuery的helloword
$(function(){
	alert(&quot;Hello World&quot;)
})</code></p>
<hr />
<p>姓名|语文成绩|数学成绩|总成绩
 ---|:---|:---:|---:
 喜羊羊|100|120|220</p>
<hr />
<table>
<tr>
<th width=10%, bgcolor=yellow >参数</th>
<th width=40%, bgcolor=yellow>详细解释</th>
<th width="50%", bgcolor=yellow>备注</th>
</tr>
<tr>
<td bgcolor=#eeeeee> -l </td>
<td> use a long listing format  </td>
<td> 以长列表方式显示（显示出文件/文件夹详细信息）  </td>
</tr>
<tr>
<td bgcolor=#00FF00>-t </td>
<td> sort by modification time </td>
<td> 按照修改时间排序（默认最近被修改的文件/文件夹排在最前面） </td>
<tr>
<td bgcolor=rgb(0,10,0)>-r </td>
<td> reverse order while sorting </td>
<td>  逆序排列 </td>
</tr>
</table>
</main>
  <div class="p_center">
	
	<ul>
		<li>&copy; 2019 LmOrange 蜀ICP备19015312号</li>
	</ul>
	<ul>
		<li>
		<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1277763152'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s23.cnzz.com/z_stat.php%3Fid%3D1277763152%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
		</li>
	</ul>
	<ul>
		<li>友情链接：</li>
		<li><a href="https://www.baidu.com" target="_blank">百度</a></li>
		<li>阿里云</li>
		<li>淘宝</li>
		<li>凤凰网</li>
	</ul>
  </div>		
</body>
<script type="text/javascript">
	$(document).ready(function(){
		$('pre code').each(function(i, block) {
			hljs.highlightBlock(block);
		  });
	});
</script>
</html>
